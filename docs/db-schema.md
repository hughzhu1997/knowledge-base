

------

```markdown
# ğŸ—„ db-schema.md  
**é¡¹ç›®åç§°**ï¼šçŸ¥è¯†åº“è½¯ä»¶ï¼ˆKnowledge Base Systemï¼‰  
**ç‰ˆæœ¬**ï¼šv1.0  
**æ—¥æœŸ**ï¼š2025-09-26  
**ä½œè€…**ï¼šXiaohua Zhu  

---

## 1. æ¦‚è¿°
æœ¬æ–‡ä»¶å®šä¹‰äº†çŸ¥è¯†åº“è½¯ä»¶çš„æ•°æ®åº“è®¾è®¡ï¼ŒåŒ…æ‹¬ **ç”¨æˆ·ã€æ–‡æ¡£ã€æƒé™ã€ç‰ˆæœ¬è®°å½•** ç­‰æ ¸å¿ƒè¡¨ã€‚  
æ•°æ®åº“æ”¯æŒ **MongoDBï¼ˆæ–‡æ¡£å‹å­˜å‚¨ï¼‰** æˆ– **PostgreSQLï¼ˆå…³ç³»å‹å­˜å‚¨ï¼‰** ä¸¤ç§å®ç°ï¼Œå…·ä½“å¯æ ¹æ®éƒ¨ç½²éœ€æ±‚é€‰æ‹©ã€‚  

---

## 2. æ•°æ®åº“å®ä½“
### 2.1 ç”¨æˆ·è¡¨ï¼ˆUsersï¼‰
- **é›†åˆ / è¡¨å**: `users`  
- **å­—æ®µå®šä¹‰**:  

| å­—æ®µå       | ç±»å‹            | è¯´æ˜ |
|--------------|----------------|------|
| id           | ObjectId / UUID | ç”¨æˆ·å”¯ä¸€æ ‡è¯† |
| username     | String         | ç”¨æˆ·å |
| email        | String (å”¯ä¸€)  | é‚®ç®±åœ°å€ |
| password     | String (Hash)  | å¯†ç ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰ |
| role         | String         | ç”¨æˆ·è§’è‰²ï¼ˆadmin / developer / userï¼‰ |
| createdAt    | DateTime       | åˆ›å»ºæ—¶é—´ |
| updatedAt    | DateTime       | æ›´æ–°æ—¶é—´ |

---

### 2.2 æ–‡æ¡£è¡¨ï¼ˆDocumentsï¼‰
- **é›†åˆ / è¡¨å**: `documents`  
- **å­—æ®µå®šä¹‰**:  

| å­—æ®µå       | ç±»å‹            | è¯´æ˜ |
|--------------|----------------|------|
| id           | ObjectId / UUID | æ–‡æ¡£å”¯ä¸€æ ‡è¯† |
| title        | String         | æ–‡æ¡£æ ‡é¢˜ |
| category     | String         | æ–‡æ¡£åˆ†ç±»ï¼ˆprd / architecture / api / db / code / dependencyï¼‰ |
| content      | Text (Markdown) | æ–‡æ¡£å†…å®¹ |
| authorId     | ObjectId / UUID | ä½œè€…ç”¨æˆ· IDï¼ˆå¤–é”®ï¼‰ |
| version      | Integer        | å½“å‰ç‰ˆæœ¬å· |
| createdAt    | DateTime       | åˆ›å»ºæ—¶é—´ |
| updatedAt    | DateTime       | æ›´æ–°æ—¶é—´ |

---

### 2.3 æƒé™è¡¨ï¼ˆRoles / Permissionsï¼‰
- **é›†åˆ / è¡¨å**: `roles`  
- **å­—æ®µå®šä¹‰**:  

| å­—æ®µå       | ç±»å‹            | è¯´æ˜ |
|--------------|----------------|------|
| id           | ObjectId / UUID | å”¯ä¸€æ ‡è¯† |
| roleName     | String         | è§’è‰²åç§°ï¼ˆadmin / developer / userï¼‰ |
| permissions  | Array[String]  | æƒé™åˆ—è¡¨ï¼ˆå¦‚ï¼š`read`, `write`, `delete`, `manageUsers`ï¼‰ |

---

### 2.4 ç‰ˆæœ¬è®°å½•è¡¨ï¼ˆRevisions / Historyï¼‰
- **é›†åˆ / è¡¨å**: `revisions`  
- **å­—æ®µå®šä¹‰**:  

| å­—æ®µå       | ç±»å‹            | è¯´æ˜ |
|--------------|----------------|------|
| id           | ObjectId / UUID | å”¯ä¸€æ ‡è¯† |
| documentId   | ObjectId / UUID | æ–‡æ¡£ IDï¼ˆå¤–é”®ï¼‰ |
| version      | Integer        | ç‰ˆæœ¬å· |
| content      | Text (Markdown) | æ–‡æ¡£å¿«ç…§å†…å®¹ |
| updatedBy    | ObjectId / UUID | ä¿®æ”¹äºº ID |
| updatedAt    | DateTime       | ä¿®æ”¹æ—¶é—´ |

---

## 3. å…³ç³»å›¾ï¼ˆé€»è¾‘æ¨¡å‹ï¼‰
```

Users (1) -------- (N) Documents
 |                    |
 |                    |
 |                 (N) Revisions
 |
 +---- (N) Roles (permissions)

```
---

## 4. ç´¢å¼•ä¸ä¼˜åŒ–
- **Users**
  - `email` å”¯ä¸€ç´¢å¼•  
- **Documents**
  - `title` æ™®é€šç´¢å¼•  
  - `category` æ™®é€šç´¢å¼•  
- **Revisions**
  - `documentId` å¤–é”®ç´¢å¼•  
  - `updatedAt` æ—¶é—´ç´¢å¼•  

---

## 5. æœªæ¥æ‰©å±•
- **æ ‡ç­¾è¡¨ï¼ˆTagsï¼‰**ï¼šæ”¯æŒç»™æ–‡æ¡£æ·»åŠ å¤šä¸ªæ ‡ç­¾ã€‚  
- **è¯„è®ºè¡¨ï¼ˆCommentsï¼‰**ï¼šæ”¯æŒç”¨æˆ·åœ¨æ–‡æ¡£ä¸‹è¯„è®ºã€‚  
- **å®¡è®¡æ—¥å¿—ï¼ˆAuditLogsï¼‰**ï¼šè®°å½•ç”¨æˆ·çš„å…³é”®æ“ä½œï¼ˆç™»å½•ã€åˆ é™¤ã€ä¿®æ”¹æƒé™ï¼‰ã€‚  

---

## 6. é™„å½•
- `PRD.md` â†’ äº§å“éœ€æ±‚æ–‡æ¡£  
- `architecture.md` â†’ ç³»ç»Ÿæ¶æ„  
- `api-spec.md` â†’ API è§„èŒƒ  
- `CODESTYLE.md` â†’ ç¼–ç è§„èŒƒ  
- `dependencies.md` â†’ ä¾èµ–è¯´æ˜  

---

âœ… **è¯´æ˜**ï¼šæœ¬æ•°æ®åº“è®¾è®¡ä¸ºç¬¬ä¸€ç‰ˆï¼Œåç»­ä¼šæ ¹æ®å®é™…å¼€å‘éœ€æ±‚é€æ­¥å®Œå–„ã€‚  
```

------

