å¥½çš„ ğŸ‘ æˆ‘æ¥å¸®ä½ ç”Ÿæˆä¸€ä»½ **ç¬¬ä¸€ç‰ˆ api-spec.md**ï¼Œä¿æŒæ¸…æ™°çš„æ¥å£æ–‡æ¡£é£æ ¼ï¼Œæ–¹ä¾¿ä½ ç›´æ¥å¤åˆ¶åˆ° Cursor çš„ `/docs/api-spec.md` æ–‡ä»¶ä¿å­˜ã€‚

------

~~~markdown
# ğŸ”Œ api-spec.md  
**é¡¹ç›®åç§°**ï¼šçŸ¥è¯†åº“è½¯ä»¶ï¼ˆKnowledge Base Systemï¼‰  
**ç‰ˆæœ¬**ï¼šv1.0  
**æ—¥æœŸ**ï¼š2025-09-26  
**ä½œè€…**ï¼šXiaohua Zhu  

---

## 1. æ¦‚è¿°
æœ¬æ–‡ä»¶å®šä¹‰äº†çŸ¥è¯†åº“è½¯ä»¶çš„ **API è§„èŒƒ**ï¼ŒåŒ…æ‹¬æ–‡æ¡£ç®¡ç†ã€ç”¨æˆ·è®¤è¯ã€æœç´¢åŠŸèƒ½ä»¥åŠåç»­æ‰©å±•æ¥å£ã€‚  
æ‰€æœ‰æ¥å£éµå¾ª **RESTful é£æ ¼**ï¼Œè¿”å›æ•°æ®æ ¼å¼ä¸º **JSON**ã€‚  
è®¤è¯æ–¹å¼é‡‡ç”¨ **JWT (Bearer Token)**ã€‚  

---

## 2. è®¤è¯ä¸æƒé™
### 2.1 ç”¨æˆ·æ³¨å†Œ
- **URL**: `/api/auth/register`  
- **æ–¹æ³•**: `POST`  
- **è¯·æ±‚å‚æ•°**:
```json
{
  "username": "hugh",
  "email": "hugh@example.com",
  "password": "123456"
}
~~~

- **å“åº”**:

```json
{
  "message": "User registered successfully"
}
```

### 2.2 ç”¨æˆ·ç™»å½•

- **URL**: `/api/auth/login`
- **æ–¹æ³•**: `POST`
- **è¯·æ±‚å‚æ•°**:

```json
{
  "email": "hugh@example.com",
  "password": "123456"
}
```

- **å“åº”**:

```json
{
  "token": "jwt_token_string",
  "expiresIn": 3600
}
```

------

## 3. æ–‡æ¡£ç®¡ç† API

### 3.1 è·å–æ‰€æœ‰æ–‡æ¡£

- **URL**: `/api/docs`
- **æ–¹æ³•**: `GET`
- **æƒé™**: ç”¨æˆ·ç™»å½•åå¯è®¿é—®
- **å“åº”**:

```json
[
  {
    "id": "123",
    "title": "PRD æ–‡æ¡£",
    "category": "éœ€æ±‚",
    "updatedAt": "2025-09-26T12:00:00Z"
  }
]
```

### 3.2 è·å–å•ä¸ªæ–‡æ¡£

- **URL**: `/api/docs/:id`
- **æ–¹æ³•**: `GET`
- **å“åº”**:

```json
{
  "id": "123",
  "title": "PRD æ–‡æ¡£",
  "content": "# å†…å®¹",
  "updatedAt": "2025-09-26T12:00:00Z"
}
```

### 3.3 åˆ›å»ºæ–‡æ¡£

- **URL**: `/api/docs`
- **æ–¹æ³•**: `POST`
- **è¯·æ±‚å‚æ•°**:

```json
{
  "title": "æ–°æ–‡æ¡£",
  "category": "æ¶æ„",
  "content": "Markdown æ ¼å¼å†…å®¹"
}
```

- **å“åº”**:

```json
{
  "id": "456",
  "message": "Document created successfully"
}
```

### 3.4 æ›´æ–°æ–‡æ¡£

- **URL**: `/api/docs/:id`
- **æ–¹æ³•**: `PUT`
- **è¯·æ±‚å‚æ•°**:

```json
{
  "title": "æ›´æ–°åçš„æ–‡æ¡£",
  "content": "æ–°å†…å®¹"
}
```

- **å“åº”**:

```json
{
  "message": "Document updated successfully"
}
```

### 3.5 åˆ é™¤æ–‡æ¡£

- **URL**: `/api/docs/:id`
- **æ–¹æ³•**: `DELETE`
- **å“åº”**:

```json
{
  "message": "Document deleted successfully"
}
```

------

## 4. æœç´¢ API

### 4.1 å…¨æ–‡æœç´¢

- **URL**: `/api/search`
- **æ–¹æ³•**: `GET`
- **å‚æ•°**:
  - `q`: æœç´¢å…³é”®å­—
- **ç¤ºä¾‹**:
   `/api/search?q=API`
- **å“åº”**:

```json
[
  {
    "id": "123",
    "title": "API è§„èŒƒ",
    "snippet": "æœ¬æ–‡ä»¶å®šä¹‰äº†çŸ¥è¯†åº“è½¯ä»¶çš„ API è§„èŒƒ",
    "updatedAt": "2025-09-26T12:00:00Z"
  }
]
```

------

## 5. ç®¡ç†å‘˜ API

### 5.1 ç”¨æˆ·åˆ—è¡¨

- **URL**: `/api/admin/users`
- **æ–¹æ³•**: `GET`
- **æƒé™**: ä»…ç®¡ç†å‘˜å¯è®¿é—®
- **å“åº”**:

```json
[
  {
    "id": "u001",
    "username": "hugh",
    "role": "admin"
  }
]
```

### 5.2 ä¿®æ”¹ç”¨æˆ·æƒé™

- **URL**: `/api/admin/users/:id/role`
- **æ–¹æ³•**: `PUT`
- **è¯·æ±‚å‚æ•°**:

```json
{
  "role": "developer"
}
```

- **å“åº”**:

```json
{
  "message": "User role updated successfully"
}
```

------

## 6. NLP æ¨¡å— APIï¼ˆé¢„ç•™ï¼‰

### 6.1 é—®ç­”æ¥å£

- **URL**: `/api/nlp/query`
- **æ–¹æ³•**: `POST`
- **è¯·æ±‚å‚æ•°**:

```json
{
  "question": "å¦‚ä½•åˆ›å»ºæ–°æ–‡æ¡£ï¼Ÿ"
}
```

- **å“åº”**:

```json
{
  "answer": "åœ¨ /api/docs ä½¿ç”¨ POST è¯·æ±‚åˆ›å»ºæ–°æ–‡æ¡£"
}
```

------

## 7. é”™è¯¯ç å®šä¹‰

| é”™è¯¯ç  | æè¿°         |
| ------ | ------------ |
| 400    | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401    | æœªæˆæƒè®¿é—®   |
| 403    | æƒé™ä¸è¶³     |
| 404    | èµ„æºä¸å­˜åœ¨   |
| 500    | æœåŠ¡å™¨é”™è¯¯   |

------

## 8. é™„å½•

- `PRD.md` â†’ äº§å“éœ€æ±‚æ–‡æ¡£
- `architecture.md` â†’ ç³»ç»Ÿæ¶æ„
- `db-schema.md` â†’ æ•°æ®åº“è®¾è®¡
- `CODESTYLE.md` â†’ ç¼–ç è§„èŒƒ
- `dependencies.md` â†’ ä¾èµ–è¯´æ˜

------

âœ… **è¯´æ˜**ï¼šæ­¤ API è§„èŒƒä¸ºç¬¬ä¸€ç‰ˆï¼Œåç»­ä¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­é€æ­¥æ‰©å±•ã€‚

```
---

è¦ä¸è¦æˆ‘æ¥ç€å¸®ä½ ç”Ÿæˆ **db-schema.md çš„ç¬¬ä¸€ç‰ˆ**ï¼Ÿè¿™æ · `/docs` é‡Œçš„å››å¤§æ ¸å¿ƒæ–‡æ¡£å°±é½äº†ã€‚
```